{% extends 'base_panel.html' %}

{% block content %}
<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Puntos de Venta</h1>
        <a href="{% url 'agregar_punto_venta' %}" class="btn btn-success">
            Agregar Punto de Venta
        </a>
    </div>
    
    <div class="mb-3">
        <a href="{% url 'inicio_admin' %}" class="btn btn-secondary btn-sm">Volver al Panel</a>
        <a href="/quienes-somos/" class="btn btn-outline-secondary btn-sm" target="_blank">Ver en Página Web</a>
    </div>

    {% if puntos %}
        <div class="row">
                {% for punto in puntos %}
            <div class="col-md-3 mb-4">
                <div class="card h-100 text-center" style="border: 1px solid #bbf7d0; border-radius: 1rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;" 
                     {% if punto.link_mapa %}onclick="window.open('{{ punto.link_mapa }}', '_blank')"{% endif %}>
                    <svg style="width: 3rem; height: 3rem; margin: 0 auto 1rem; color: #0f7a3a;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <h5 class="text-success mb-2 fw-semibold">{{ punto.nombre }}</h5>
                    <p class="text-muted small mb-2">{{ punto.direccion }}</p>
                    {% if punto.ciudad %}
                    <p class="text-muted" style="font-size: 0.75rem;">{{ punto.ciudad }}{% if punto.region %}, {{ punto.region }}{% endif %}</p>
                    {% endif %}
                    {% if punto.link_mapa %}
                    <p class="text-success" style="font-size: 0.75rem; margin-top: 0.5rem;">Click para ver en mapa</p>
                        {% endif %}
                    
                    <div class="mt-3 pt-3 border-top">
                        <span class="badge {% if punto.activo %}bg-success{% else %}bg-danger{% endif %} mb-2">
                            {% if punto.activo %}Activo{% else %}Inactivo{% endif %}
                        </span>
                        <div class="d-flex gap-2">
                            <a href="{% url 'editar_punto_venta' punto.pk %}" class="btn btn-warning btn-sm flex-fill" onclick="event.stopPropagation();">
                                Editar
                            </a>
                        <form method="post" action="{% url 'eliminar_punto_venta' punto.pk %}"
                                  style="flex: 1; margin: 0;"
                                  onsubmit="return confirm('¿Seguro que quieres eliminar este punto de venta?');"
                                  onclick="event.stopPropagation();">
                            {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm w-100">
                                    Eliminar
                                </button>
                        </form>
                        </div>
                    </div>
                </div>
            </div>
                {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info text-center">
            <h4>Todavía no has registrado puntos de venta</h4>
            <p>Comienza agregando tu primer punto de venta para que aparezca en el sitio</p>
            <a href="{% url 'agregar_punto_venta' %}" class="btn btn-primary">
                Agregar Primer Punto de Venta
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}
